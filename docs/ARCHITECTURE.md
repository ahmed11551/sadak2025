# Sadaka-Pass - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

Sadaka-Pass ‚Äî —ç—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –≤–Ω—É—Ç—Ä–∏ Telegram Mini App MubarakWay, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π:
- –ï–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è (—Å–∞–¥–∞–∫–∞, —Å–∞–¥–∞–∫–∞-–¥–∂–∞—Ä–∏—è)
- –¶–µ–ª–µ–≤—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É—á–∞—Å—Ç–∏–µ)
- –ö–∞—Ç–∞–ª–æ–≥ —Ñ–æ–Ω–¥–æ–≤-–ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤
- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–∞–∫—è—Ç–∞
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegram Bot  ‚îÇ    ‚îÇ   Telegram      ‚îÇ    ‚îÇ   Admin Panel   ‚îÇ
‚îÇ   (aiogram)     ‚îÇ    ‚îÇ   Mini App      ‚îÇ    ‚îÇ   (React)       ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ   (React/TS)    ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                      ‚îÇ                      ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ     Backend API           ‚îÇ
                    ‚îÇ   (Python/FastAPI)        ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                  ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                         ‚îÇ                         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PostgreSQL   ‚îÇ    ‚îÇ     Elasticsearch        ‚îÇ    ‚îÇ    Redis    ‚îÇ
‚îÇ   Database    ‚îÇ    ‚îÇ     (Search Engine)      ‚îÇ    ‚îÇ   (Cache)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                         ‚îÇ                         ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                  ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   External Services       ‚îÇ
                    ‚îÇ  YooKassa, CloudPayments  ‚îÇ
                    ‚îÇ  bot.e-replika.ru API     ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend:**
- Python 3.11+
- FastAPI - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- SQLAlchemy - ORM
- Alembic - –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- Pydantic - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- aiogram - Telegram Bot API

**Frontend:**
- React 18 + TypeScript
- Telegram WebApp SDK
- React Router - –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- Axios - HTTP –∫–ª–∏–µ–Ω—Ç
- Styled Components - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- PostgreSQL - –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î
- Elasticsearch - –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- Redis - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã:**
- YooKassa (–†–§)
- CloudPayments (–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ)

## üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

#### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    telegram_id INTEGER UNIQUE NOT NULL,
    username VARCHAR(255),
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    language_code VARCHAR(10) DEFAULT 'ru',
    locale VARCHAR(10) DEFAULT 'ru',
    timezone VARCHAR(50) DEFAULT 'UTC',
    madhab VARCHAR(50),
    is_premium BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE
);
```

#### Fund (–§–æ–Ω–¥)
```sql
CREATE TABLE funds (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    country_code VARCHAR(3) NOT NULL,
    purposes JSONB,
    logo_url VARCHAR(500),
    website_url VARCHAR(500),
    contact_info JSONB,
    verified BOOLEAN DEFAULT FALSE,
    active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE
);
```

#### Campaign (–ö–∞–º–ø–∞–Ω–∏—è)
```sql
CREATE TABLE campaigns (
    id SERIAL PRIMARY KEY,
    owner_id INTEGER REFERENCES users(id),
    fund_id INTEGER REFERENCES funds(id),
    title VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    category VARCHAR(100) NOT NULL,
    goal_amount DECIMAL(10,2) NOT NULL,
    collected_amount DECIMAL(10,2) DEFAULT 0,
    country_code VARCHAR(3) NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    end_date DATE,
    banner_url VARCHAR(500),
    participants_count INTEGER DEFAULT 0,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE
);
```

#### SubscriptionPlan (–¢–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω)
```sql
CREATE TABLE subscription_plans (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    display_name VARCHAR(100) NOT NULL,
    description TEXT,
    price_monthly DECIMAL(10,2) NOT NULL,
    price_3months DECIMAL(10,2),
    price_6months DECIMAL(10,2),
    price_12months DECIMAL(10,2),
    charity_percentage DECIMAL(5,2) DEFAULT 0,
    features JSONB,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE
);
```

## üîå API Endpoints

### –û—Å–Ω–æ–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

#### –§–æ–Ω–¥—ã
- `GET /api/v1/funds` - —Å–ø–∏—Å–æ–∫ —Ñ–æ–Ω–¥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /api/v1/funds/{id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–æ–Ω–¥–µ
- `POST /api/v1/funds` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ–Ω–¥–∞ (–∞–¥–º–∏–Ω)
- `PUT /api/v1/funds/{id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–¥–∞ (–∞–¥–º–∏–Ω)

#### –ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è
- `POST /api/v1/donations/init` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è
- `POST /api/v1/donations/{id}/confirm` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `GET /api/v1/donations/{id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–∏
- `GET /api/v1/donations/user/{user_id}` - –∏—Å—Ç–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –ü–æ–¥–ø–∏—Å–∫–∏
- `POST /api/v1/subscriptions/init` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- `GET /api/v1/subscriptions/{id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–µ
- `PATCH /api/v1/subscriptions/{id}` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π
- `POST /api/v1/subscriptions/{id}/pause` - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞
- `POST /api/v1/subscriptions/{id}/resume` - –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `POST /api/v1/subscriptions/{id}/cancel` - –æ—Ç–º–µ–Ω–∞

#### –ö–∞–º–ø–∞–Ω–∏–∏
- `GET /api/v1/campaigns` - —Å–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π
- `GET /api/v1/campaigns/{id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–º–ø–∞–Ω–∏–∏
- `POST /api/v1/campaigns` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏
- `POST /api/v1/campaigns/{id}/donate` - –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–º–ø–∞–Ω–∏—é
- `GET /api/v1/campaigns/{id}/donations` - –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–∏
- `GET /api/v1/campaigns/{id}/report` - –æ—Ç—á–µ—Ç –ø–æ –∫–∞–º–ø–∞–Ω–∏–∏

#### –ó–∞–∫—è—Ç
- `POST /api/v1/zakat/calc` - —Ä–∞—Å—á–µ—Ç –∑–∞–∫—è—Ç–∞
- `POST /api/v1/zakat/pay` - –æ–ø–ª–∞—Ç–∞ –∑–∞–∫—è—Ç–∞
- `GET /api/v1/zakat/user/{user_id}` - –∏—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤
- `GET /api/v1/zakat/nisab` - —Ç–µ–∫—É—â–∏–π –Ω–∏—Å–∞–±

#### –ü–∞—Ä—Ç–Ω–µ—Ä—ã
- `POST /api/v1/partners/applications` - –ø–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏
- `GET /api/v1/partners/applications` - —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ (–∞–¥–º–∏–Ω)
- `PATCH /api/v1/partners/applications/{id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `POST /api/v1/partners/applications/{id}/approve` - –æ–¥–æ–±—Ä–µ–Ω–∏–µ
- `POST /api/v1/partners/applications/{id}/reject` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ

## üí≥ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

### –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

```python
def select_payment_provider(card_bin: str, country_code: str) -> str:
    """
    –í—ã–±–æ—Ä –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ BIN –∫–∞—Ä—Ç—ã –∏ —Å—Ç—Ä–∞–Ω—ã
    """
    # –†–æ—Å—Å–∏–π—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
    if country_code == "RU" or card_bin.startswith(("4", "5")):
        return "yookassa"
    
    # –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –∫–∞—Ä—Ç—ã
    return "cloudpayments"
```

### Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞

```python
@app.post("/api/v1/webhooks/yookassa")
async def yookassa_webhook(request: Request):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç YooKassa"""
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

@app.post("/api/v1/webhooks/cloudpayments")
async def cloudpayments_webhook(request: Request):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç CloudPayments"""
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

## üîç Elasticsearch –∏–Ω–¥–µ–∫—Å—ã

### –ò–Ω–¥–µ–∫—Å —Ñ–æ–Ω–¥–æ–≤
```json
{
  "mappings": {
    "properties": {
      "id": {"type": "keyword"},
      "name": {
        "type": "text",
        "fields": {
          "keyword": {"type": "keyword"}
        }
      },
      "description": {"type": "text"},
      "country_code": {"type": "keyword"},
      "purposes": {"type": "keyword"},
      "verified": {"type": "boolean"},
      "active": {"type": "boolean"},
      "created_at": {"type": "date"}
    }
  }
}
```

### –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
```json
{
  "query": {
    "bool": {
      "must": [
        {"term": {"active": true}},
        {"term": {"verified": true}}
      ],
      "filter": [
        {"terms": {"country_code": ["RU", "KZ", "TR"]}},
        {"terms": {"purposes": ["mosque", "orphans", "medical"]}}
      ]
    }
  },
  "sort": [
    {"verified": {"order": "desc"}},
    {"_score": {"order": "desc"}}
  ]
}
```

## üì± Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Inline —Ä–µ–∂–∏–º
```python
# –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
/sadaqa - –æ—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å"
/support - –±—ã—Å—Ç—Ä—ã–µ –¥–æ–Ω–∞—Ç—ã
/zakat - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–∞–∫—è—Ç–∞
/campaigns - —Å–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π
/partners - –∫–∞—Ç–∞–ª–æ–≥ —Ñ–æ–Ω–¥–æ–≤

# Callback data –ø—Ä–∏–º–µ—Ä—ã
donate:fund=123;sum=500
support:sum=1000
sub:plan=premium;period=P12M
campaign:join:456
zakat:calc
```

### WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

// –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç
tg.sendData(JSON.stringify({
  type: 'donation_completed',
  amount: 1000,
  fund_id: 123
}));
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram WebApp initData
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è API –¥–æ—Å—Ç—É–ø–∞
- Rate limiting (50 req/min per user)

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- SQL injection –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ SQLAlchemy
- XSS –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—é

### –ü–ª–∞—Ç–µ–∂–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è webhook'–æ–≤
- –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ Vault
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

### –°–æ–±—ã—Ç–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```python
# –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π
EVENT_TYPES = [
    'donation_initiated',
    'donation_completed',
    'subscription_created',
    'subscription_cancelled',
    'campaign_created',
    'campaign_joined',
    'zakat_calculated',
    'partner_applied'
]
```

### –û—Ç—á–µ—Ç—ã —Ñ–æ–Ω–¥–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ webhook
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PDF, CSV, XLSX —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
- –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üöÄ –î–µ–ø–ª–æ–π –∏ DevOps

### Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```yaml
# docker-compose.yml
services:
  backend:
    build: ./backend
    ports: ["8000:8000"]
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres:5432/sadaka_pass
    depends_on: [postgres, redis, elasticsearch]
  
  frontend:
    build: ./frontend
    ports: ["3000:3000"]
    environment:
      - REACT_APP_API_URL=http://localhost:8000
```

### CI/CD Pipeline
```yaml
# .github/workflows/deploy.yml
name: Deploy
on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: |
          cd backend && pytest
          cd frontend && npm test
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Structured logging –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ ELK Stack
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –ú–µ—Ç—Ä–∏–∫–∏
- Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- Uptime –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –û—à–∏–±–∫–∏
- Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# Backend
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn app.main:app --reload

# Frontend
cd frontend
npm install
npm start

# Telegram Bot
cd telegram-bot
python main.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# Backend —Ç–µ—Å—Ç—ã
cd backend
pytest

# Frontend —Ç–µ—Å—Ç—ã
cd frontend
npm test

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
docker-compose -f docker-compose.test.yml up --abort-on-container-exit
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](http://localhost:8000/docs)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Telegram WebApp](https://core.telegram.org/bots/webapps)
- [YooKassa API](https://yookassa.ru/developers/api)
- [CloudPayments API](https://developers.cloudpayments.ru/)
